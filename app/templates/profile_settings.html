<!-- profile_settings.html -->
{% extends "base.html" %}

{% block container %}

<input type="hidden" id="csrf_token" name="csrf_token" value="{{ csrf_token() }}">
<div class="container flex_column">
    
    <!-- –ë–ª–æ–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∞–º–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="profile-settings-block">
        <h3 class="profile-settings-block__title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</h3>
        <div class="profile-settings-block__container">
            <ul class="profile-settings-block__list" data-profile-id="{{ profile.id }}" id="profileSettingBlock">
                <li class="profile-settings-block__item">
                    <label class="profile-settings-block__label" for="profile_name">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è:</label>
                    <input class="profile-settings-block__input" type="text" id="profileName" name="profile_name" value="{{ profile.profile_name }}" required>
                </li>
                <li class="profile-settings-block__item">
                    <label class="profile-settings-block__label" for="description">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è:</label>
                    <textarea class="profile-settings-block__textarea" id="profileDescription" name="description">{{ profile.description }}</textarea>
                </li>
                <li class="profile-settings-block__item">
                    <label class="profile-settings-block__label" for="userName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" class="profile-settings-block__select" id="userName" value="{{ profile.username }}" name="userName">
                </li>
                <br>
                <li class="profile-settings-block__item">
                    <label class="profile-settings-block__label" for="userEmail">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞:</label>
                    <input
                        type="email"
                        class="profile-settings-block__select"
                        id="userEmail"
                        value="{{ current_user.email }}"
                        name="userEmail"
                        readonly
                        style="background:#f3f3f3;"
                    >
                    <a href="/change-email" class="btn " id="changeEmailBtn" style="margin-left: 10px;">
                        –ò–∑–º–µ–Ω–∏—Ç—å
                    </a>
                </li>
                <br>
                <li class="profile-settings-block__item">
                    <label class="profile-settings-block__label" for="default_profile">–ü—Ä–æ—Ñ–∏–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:</label>
                    <input class="profile-settings-block__input" type="checkbox" id="isDefauleProfile" name="default_profile" {% if profile.default_profile %} checked {% endif %}>
                </li>
            </ul>
            <div class="profile-setting-block__wrapper--buttons">
                <button class="btn  profile-settings-block__btn" id="saveSettingProfile" type="button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                <button class="btn  profile-settings-block__btn" id="deleteProfile" type="button">–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                <button class="btn  profile-settings-block__btn" id="shareProfileButton" type="button">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ—Ñ–∏–ª–µ–º</button>
                <div class="profile-settings-block__share-email-block" id="shareProfileEmailBlock" style="display: none;">
                    <input type="email" id="shareEmailInput" placeholder="–í–≤–µ–¥–∏—Ç–µ email" class="share-popup__input">
                    <button class="btn profile-settings-block__btn" type="button" id="submitShareProfileButton">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
                <button class="btn  profile-settings-block__btn" id="rebuildModalitiesFromDB" type="button">–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏

                </button>
            </div>
        </div>
    </div>
    
    
    <!-- –ë–ª–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π –∏ –æ–±–ª–∞—Å—Ç–µ–π –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è -->
    <div class="flex">
        <div id="modalitiesContainer">
            <h3 class="settings-block__title">–ú–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏</h3>
            {% if categories %}
            <ul class="categories-tree">
                {% for cat in categories %}
                    <li>
                        <label>
                            <input type="radio"
                                   name="modality_radio"
                                   class="modality-radio"
                                   value="{{ cat.id }}">
                            <span class="category-name">{{ cat.name }}</span>
                            <span class="category-id">({{ cat.global_name }})</span>
                        </label>
                        <span class="category-actions">
                            <button class="edit-category-btn" data-id="{{ cat.id }}" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">‚úèÔ∏è</button>
                            <button class="delete-category-btn" data-id="{{ cat.id }}" title="–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">üóëÔ∏è</button>
                            <button class="change-global-category-btn" data-id="{{ cat.id }}" title="–ü–æ–º–µ–Ω—è—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é">üíª</button>
                        </span>
                    </li>
                {% endfor %}
            </ul>
            <button class="btn" id="addModalityButton">–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å</button>
            {% else %}
            <div>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</div>
            {% endif %}
        </div>
    
        <div id="areasContainer">
            <h3 class="settings-block__title">–û–±–ª–∞—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</h3>
            <ul class="areas-list" id="areasList">
                <!-- –ó–∞–ø–æ–ª–Ω—é –≤ js -->
            </ul>
            <div id="areasActions">
                <button class="btn" id="addAreaButton">–î–æ–±–∞–≤–∏—Ç—å –æ–±–ª–∞—Å—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</button>
            </div>
        </div>
    </div>
    

    <!-- –ë–ª–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—Ñ–∏–ª—è –≤ –ë–î -->
        <!-- –ò–º—è –∏–Ω–ø—É—Ç–∞ –¥–æ–ª–∂–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∫–ª—é—á–æ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        –≤ DEFAULT_PROFILE_SETTINGS –≤ config.py  -->
    <div class="flex container">
        {% if user_max_rank > 2 %}
            {% if user_settings %}
                <div class="settings-block">
                    <h3 class="settings-block__title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                    <br>
                    <ul class="settings-block__list" id="settings-block">
                        <li class="settings-block__item">
                            <label class="label" for="useWordReports">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã–≥—Ä—É–∑–∫—É –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –≤ word</label>
                            <input class="checkbox" type="checkbox" id="useWordReports" name="USE_WORD_REPORTS"
                                {% if user_settings.USE_WORD_REPORTS %} checked {% endif %}>
                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="useSentenceAutosaveForDynamicReport">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞</label>
                            <input class="checkbox" type="checkbox" id="useSentenceAutosaveForDynamicReport" name="USE_SENTENCE_AUTOSAVE_FOR_DYNAMIC_REPORT"
                                {% if user_settings.USE_SENTENCE_AUTOSAVE_FOR_DYNAMIC_REPORT %} checked {% endif %}>
                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="useSentenceAutosave">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</label>
                            <input class="checkbox" type="checkbox" id="useSentenceAutosave" name="USE_SENTENCE_AUTOSAVE"
                                {% if user_settings.USE_SENTENCE_AUTOSAVE %} checked {% endif %}>
                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="appLanguage">–Ø–∑—ã–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:</label>
                            <select class="select" id="appLanguage" name="APP_LANGUAGE">
                                <option value="ru" {% if user_settings.APP_LANGUAGE == 'ru' %}selected{% endif %}>—Ä—É—Å—Å–∫–∏–π</option>
                                <option value="eng" {% if user_settings.APP_LANGUAGE == 'eng' %}selected{% endif %}>–∞–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                            </select>
                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="appTheme">Theme:</label>
                            <select class="select" id="appTheme" name="APP_THEME">
                                <option value="light" {% if user_settings.APP_THEME == 'light' %}selected{% endif %}>Light</option>
                                <option value="dark" {% if user_settings.APP_THEME == 'dark' %}selected{% endif %}>Dark</option>
                            </select>
                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="similarityThesholdFuzz">–ü–æ—Ä–æ–≥ —Å—Ö–æ–∂–¥–µ–Ω–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:</label>
                            <input class="select" id="similarityThesholdFuzz" name="SIMILARITY_THRESHOLD_FUZZ" value="{{ user_settings.SIMILARITY_THRESHOLD_FUZZ }}">

                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="exceptWords">–°–ª–æ–≤–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞:</label>
                            <input type="text" class="input" id="exceptWords" name="EXCEPT_WORDS" value="{{ user_settings.EXCEPT_WORDS }}">

                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="exceptionsAfterPunctuation">–°–ª–æ–≤–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã:</label>
                            <input type="text" class="input" id="exceptionsAfterPunctuation" name="EXCEPTIONS_AFTER_PUNCTUATION" value="{{ user_settings.EXCEPTIONS_AFTER_PUNCTUATION }}">

                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="categoriesSetup">–°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                            <input class="input" type="text" id="categoriesSetup" name="CATEGORIES_SETUP"
                                value="{{ user_settings.CATEGORIES_SETUP | tojson | safe }}">
                        <li><h3>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞ –Ω–µ —Ç—Ä–æ–≥–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—à–µ. –ù–∏–∂–µ –º–æ–∂–Ω–æ.</h3></li>

                        <li class="settings-block__item">
                            <label class="label" for="useSentenceAICheckDefault">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</label>
                            <input class="checkbox" type="checkbox" id="useSentenceAICheckDefault" name="USE_SENTENCE_AI_CHECK_DEFAULT"
                                {% if user_settings.USE_SENTENCE_AI_CHECK_DEFAULT %} checked {% endif %}>

                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="useFirstGrammaSentenceDefault">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</label>
                            <input class="checkbox" type="checkbox" id="useFirstGrammaSentenceDefault" name="USE_FIRST_GRAMMA_SENTENCE_DEFAULT"
                                {% if user_settings.USE_FIRST_GRAMMA_SENTENCE_DEFAULT %} checked {% endif %}>

                        </li>
                        <li class="settings-block__item">
                            <label class="label" for="useDublicateSearchDefault">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</label>
                            <input class="checkbox" type="checkbox" id="useDublicateSearchDefault" name="USE_DUBLICATE_SEARCH_DEFAULT"
                                {% if user_settings.USE_DUBLICATE_SEARCH_DEFAULT %} checked {% endif %}>

                        </li>
                    </ul>
                    <br>
                    <br>
                    <span>--------------------------------------------------------------</span><br>
                    <button class="btn  settings-block__btn" type="button" id="saveSettings">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            {% else %}
            <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            {% endif %}

            <!-- –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–ª–æ–∫ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
            <div class="settings-block profile-settings-block">
                {% if user_settings %}
                    <ul>
                        {% for key, value in user_settings.items() %}
                            <li class="flex">
                                <p>{{ key }}: </p> <p>{{ value }}</p>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                {% endif %}
            </div>
        {% else %}
        <p>–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—Ñ–∏–ª—è (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞).</p>
        {% endif %}
    </div>

    <!-- –ë–ª–æ–∫ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —á–µ–∫–µ—Ä–æ–≤ -->
    <div class="report-check">
        {% if user_max_rank == 4 %}
        <div class="report-check__buttons-block">
            <h3 class="report-check_title">–†–∞–∑–ª–∏—á–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</h3>
            <p> –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫</p>
            <button class"btn  report-check__btn" id="startCheckersButton">–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ </button>
        </div>

        {% else %}
        <p>–£ –≤–∞—Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞).</p>
        {% endif %}
    </div>

</div>
    

{% endblock container %}


{% block scripts %}
<script>
    window.globalCategoriesTree = {{ categories | tojson | safe }};
</script>

<script src="{{ url_for('static', filename='js/profile_settings.js') }}"></script>

{% endblock scripts %}
