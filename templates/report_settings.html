<!-- report_settings.html -->

{% extends "base.html" %}
{% block container %}

<input type="hidden" id="csrf_token" name="csrf_token" value="{{ csrf_token() }}">


<div class="flex report-settings__container">
    <section class="section report-settings__section report-settings__section--types">
        <!-- Добавление нового типа протокола -->
        <div class="flex report-settings__box" id="newTypeForm">
            <label for="newTypeInput" class="label report-settings__label">New Type:</label>
            <input class="input report-settings__input" type="text" id="newTypeInput" name="new_type">
            <button class="btn report__btn report-settings__btn" id="newTypeButton" type="button">Добавить новый тип</button>
        </div>
    
        <!--Список типов-->
        <div class="report-settings__box">
            <label class="report_label__item" for="type_type">Типы протоколов:</label>
            <ul id="types-list" class="report-settings__list--types">
                {% for type in types_subtypes %}
                    <li class="flex report-settings__item report-settings__item--type" data-type-id="{{ type.type_id }}">
                        <input class="input report-settings__input report-settings__input--type" type="text" value="{{ type.type_text }}">
                        <button class="btn report__btn report-settings__btn report-settings__btn--delete-type" type="button" name="delete_type_button" data-type-id="{{ type.type_id }}">Удалить</button>
                        <button class="btn report__btn report-settings__btn report-settings__btn--edit-type" type="button" name="edit_type_button" data-type-id="{{ type.type_id }}">Сохранить изменения</button>
                    </li>
                {% endfor %}
            </ul>
        </div>
           
    </section>
    
    <section class="section report-settings__section report-settings__section--subtypes">
        <!-- Добавление нового подтипа протокола -->
        <div class="flex">
            <label class="report_label__item" for="report_subtype_type">New Subtype:</label>
            <select class="select report__select report-settings__select" id="reportTypes" required>
                {% for type in types_subtypes %}
                    <option value="{{ type.type_id }}">{{ type.type_text }}</option>
                {% endfor %}
            </select>
            <label for="new_subtype" class="report-settings__label">Новый подтип:</label>
            <input class="input report-settings__input" type="text" id="newSubtypeInput">
            <button class="btn report__btn report-settings__btn" id="newSubtypeButton" type="button">Добавить</button>
        </div>
        
        <!--Список подтипов-->
        <ul id="subtypes-list" class="report-settings__list--types_subtypes">
            {% for type in types_subtypes %}
                {% for subtype in type.subtypes  %}
                    <li class="flex report-settings__item report-settings__item--subtype" style="display: none;" data-type-id="{{ type.type_id }}">
                        <input class="input report_input__item" type="text" value="{{ type.type_text }}" readonly>
                        <input class="input report_input__item report-settings__input--subtype" type="text" value="{{ subtype.subtype_text }}">
                        <button class="btn report__btn report-settings__btn--delete-subtype" type="button" data-subtype-id="{{ subtype.subtype_id }}">Удалить</button>
                        <button class="btn report__btn report-settings__btn--edit-subtype" type="button" data-subtype-id="{{ subtype.subtype_id }}">Сохранить</button>
                    </li>
                {% endfor %}
            {% endfor %}
        </ul>
    </section>
</div>

<!-- Загрузка файла -->
 {% if user_settings.USE_WORD_REPORTS %}
    <section class="section file-upload">
        <h3>Загрузка файлов</h3>
        <div class="report_borderline"></div>
        <p>Здесь вы можете загрузить файлы шаблона Word и картинку росписи для этого шаблона</p>
        <form id="file-upload-form">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input class="file-upload-input--file-upload" type="file" name="file" id="file-input" required>
            <div>
                <label>
                    <input class="file-upload-input-radio" type="radio" name="file_type" value="template" checked>
                    Загрузить шаблон для файлов Word
                </label>
                <label>
                    <input class="file-upload-input-radio" type="radio" name="file_type" value="signature">
                    Загрузить подпись
                </label>
            </div>
            <button class="file-upload-btn-submit" type="submit">Upload</button>
        </form>
        <div class="report_borderline"></div>
    </section>
 {% endif %}


{% endblock container %}

{% block scripts %}
<!-- Подключаем js файл для этой страницы -->
<script src="/static/js/report_settings.js"></script>
{% endblock scripts %}