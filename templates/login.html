{% extends "login_base.html" %}

{% block container %}
{{ super() }}


<h1 class="title title-auth">Авторизация</h1>
<form class="flex_column" id="loginForm">
    
    <div class="wrapper wrapper--auth">
        <label class="label label--auth" for="email">E-mail:</label>
        <input class="input input--auth" type="email" id="email" name="email" required autocomplete="email"><br>
    </div>

    <div class="wrapper wrapper--auth">
        <label class="label label--auth" for="password">Password:</label>
        <input class="input input--auth" type="password" id="password" name="password" required autocomplete="current-password"><br>
    </div>

    <button class="btn btn--auth" type="button" id="loginSubmit">Войти</button>
</form>

<p>Нет аккаунта? 
    <a class="link--auth" href="{{ url_for("auth.signup") }}">Создать</a>
</p>


{% endblock container %}

{% block scripts %}
<script >
    document.getElementById('loginSubmit').addEventListener('click', function() {
        // Получаем данные из формы
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        // Формируем данные для отправки
        const data = {
            email: email,
            password: password
        };

        // Вызываем sendRequest для отправки данных
        sendRequest({
            url: "/auth/login", // URL на который отправляем данные
            method: "POST",
            data: data
        }).then(response => {
            if (response.status === 'success') {
                window.location.href = response.page;  // Меняем на url главной страницы
            } 
        }).catch(error => {
            // Ловим ошибки сети или серверные ошибки
            console.log("Ошибка при отправке данных");
        });
    });
</script>
{% endblock scripts %}